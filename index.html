<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Verifrax Verifier</title>
    <style>
      body{font-family:system-ui,Arial,sans-serif;margin:24px;max-width:960px}
      textarea{width:100%;min-height:220px;font-family:ui-monospace,Menlo,monospace}
      .row{display:flex;gap:12px;flex-wrap:wrap}
      .card{border:1px solid #ddd;border-radius:10px;padding:12px;flex:1;min-width:260px}
      .ok{font-weight:700}
      .bad{font-weight:700}
      code{font-family:ui-monospace,Menlo,monospace}
    </style>
  </head>
  <body>
    <h1>Verifrax Verifier</h1>
    <div class="row">
      <div class="card">
        <div>Paste <code>*.proof.v1.json</code></div>
        <textarea id="proof" placeholder="Paste proof JSON here"></textarea>
        <button id="verify">Verify</button>
      </div>
      <div class="card">
        <div>Status</div>
        <pre id="status">—</pre>
      </div>
    </div>
    <div class="card" style="margin-top:12px">
      <div>Parsed</div>
      <pre id="parsed">—</pre>
    </div>

    <script>
      function set(el, v){ document.getElementById(el).textContent = v; }
      document.getElementById("verify").onclick = () => {
        try{
          const raw = document.getElementById("proof").value.trim();
          const p = JSON.parse(raw);
          const okSchema = p && p.schema === "verifrax.proof.v1";
          const okHash = p && p.artifact && typeof p.artifact.sha256 === "string" && p.artifact.sha256.length === 64;

          set("parsed", JSON.stringify({
            schema: p.schema,
            repo: p.repo,
            baseline_tag: p.baseline_tag,
            core_dist_hash: p.core_dist_hash,
            artifact: p.artifact,
            verify_ref: p.verify_ref
          }, null, 2));

          if(okSchema && okHash){
            set("status", "VERIFIED (STRUCTURE OK)\nNOTE: offline UI validates schema + presence only.\nHash validation requires local file hashing.");
          } else {
            set("status", "INVALID PROOF");
          }
        } catch(e){
          set("status", "INVALID JSON");
          set("parsed", "—");
        }
      };
    </script>
  </body>
</html>
